---
title: "rnaseq_report"
format: html
---

```{r}
#| label: setup
#| message: false
#| warning: false

library(DESeq2)
library(rnaRAP)

# Load DESeq2 results produced by scripts/run_pipeline.R
res <- readRDS("../data_processed/deseq2_results.rds")

# Basic summary of results
summary(res)
```

# Top differentially expressed genes
```{r}
#| label: top-genes
#| message: false
#| warning: false

res_df <- as.data.frame(res)
res_df$gene <- rownames(res_df)

# Remove rows with NA padj, order by adjusted p-value, show top 10
top_genes <- subset(res_df, !is.na(padj))
top_genes <- top_genes[order(top_genes$padj), ]

head(top_genes[, c("gene", "log2FoldChange", "pvalue", "padj")], 10)

```

# MA Plot
```{r}
#| label: ma-plot
#| echo: false

knitr::include_graphics("ma_plot.png")
```

